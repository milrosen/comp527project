\documentclass[reqno, twoside]{article}
\input{preamble.sty}
\input{macros.sty}

\usepackage{changepage}

\begin{document}
    \title{\textbf{\normalsize\MakeUppercase{Subject Reduction for Pure Type Systems}}}
    \author{\small Charlotte Marchal | 261031516\ \ \ \ Dashiell Rich | 261002837\\\small Milton Rosenbaum | 260972050\ \ \ \ Zhaoshen Zhai | 261003108}
    \date{}
    \maketitle
    \freefootnote{\textit{Date}: \today.}
    \freefootnote{Extended abstracted for the final project for \textsc{Comp527: Logic and Computation} taught by Professor Brigitte Pientka.}
    \freefootnote{Link to presentation: \TODO}

    \begin{center}
        \vspace{-0.3in}
        \begin{minipage}{0.85\textwidth}\setstretch{0.8}
            {\footnotesize{\textsc{Abstract.}} Following \cite{GN91} and \cite{Bar91}, we study the basics of \textit{pure type systems}, which abstract many of the constructs found in the eight systems of the \textit{$\lambda$-cube}. We start with a brief introduction to the systems of the $\lambda$-cube, discuss their expressive power, and introduce pure type systems as a unifying framework in which they can be studied. We then give a detailed proof of subject reduction for arbitrary pure type systems.}
        \end{minipage}
    \end{center}

    \subsection*{Introduction}

    Subject reduction is a crucial property of a type system that guarantees its `computational consistency' by ensuring that reductions of a well-typed expression remains well-typed, and which supports the slogan that `well-typed programs do not go wrong'. It is thus desirable that we can prove it uniformly across many different type systems, and this is the goal of the present note.

    To this end, \TODO[review $\lambda$-cube and the dependencies.]

    \begin{definition}
        A \textit{pure type system} is a tuple $\sigma\coloneqq(\mc{C},\mc{S},\mc{A},\mc{R},\mc{V})$ consisting of a set $\mc{C}$ of \textit{constants}, a set $\mc{S}\subeq\mc{C}$ of \textit{sorts}, a set $\mc{A}\subeq\mc{C}^2$ of \textit{axioms}, a set $\mc{R}\subeq\mc{S}^3$ of \textit{rules}, and a set $\mc{V}$ of \textit{variables} stratified by $\mc{V}=\bigsqcup_{s\in\mc{S}}\mc{V}^s$.
    \end{definition}

    \begin{notation}
        Throughout, let $\sigma$ be denote an arbitrary pure type system.
    \end{notation}

    \TODO[link this with the $\lambda$-cube by interpreting $\lambda_\to$ as a PTS.]

    \begin{definition}
        The collection of \textit{$\sigma$-pseudoterms} is defined by $T\coloneqq\mc{V}\,|\,\mc{C}\,|\,(T\,T)\,|\,(\lambda\mc{V}\!:\!T.T)\,|\,(\Pi\mc{V}\!:\!T.T)$. Pairs $(A,B)\in T^2$ are called \textit{$\sigma$-assignments}, written $A\!:\!B$, and a finite sequence thereof is called a \textit{$\sigma$-pseudocontext}.
    \end{definition}

    \begin{definition}
        The \textit{$\beta$-reduction} relation is the least relation on $\sigma$-terms satisfying the following for all $\sigma$-terms $A,A',A''$: the \textit{principal reduction rule} $(\lambda x\!:\!A.A')A''\rightarrow_\beta A'[A''/x]$, and the \textit{congruence rules} $A\,A'\succ A\,A''$, $A'\,A\succ A''\,A$, $\lambda x\!:\!A.A'\succ\lambda x\!:\!A.A''$, $\lambda x\!:\!A'.A\succ\lambda x\!:\!A''.A$, $\Pi x\!:\!A.A'\succ\Pi x\!:\!A.A''$, and $\Pi x\!:\!A'.A\succ\Pi x\!:\!A''.A$.
    \end{definition}

    \begin{notation}
        We write $\twoheadrightarrow_\beta$ for the reflexive and transitive closure of $\rightarrow_\beta$, and $=_\beta$ for the equivalence relation generated by $\twoheadrightarrow_\beta$. A $\sigma$-term of the form $(\lambda x\!:\!A.A')A''$ is called a \textit{$\beta$-redex}.
    \end{notation}

    \begin{definition}
        Fix a $\sigma$-pseudocontext $\Gamma$ and $\sigma$-pseudoterms $M$ and $N$. We say that \textit{$\Gamma$ proves $M\!:\!N$}, and write $\Gamma\proves M\!:\!N$, if there is a finite well-founded tree $\mc{D}$, called a \textit{derivation}, such that the following hold.
        \begin{enumerate}
            \item Vertices of $\mc{D}$ are of the form $\Delta\proves A\!:\!B$, where $A$ and $B$ are $\sigma$-pseudoterms and $\Delta$ is a $\sigma$-pseudocontext.
                \vspace{-0.20in}
            \item The root of $\mc{D}$ is $\Gamma\proves M\!:\!N$.
                \vspace{-0.05in}
            \item Each interior vertex of $\mc{D}$ is a conclusion of an \textit{inference rule}, whose successors are exactly the premises.
                \vspace{-0.20in}
            \item The leaves of $\mc{D}$ are instances of an \textit{axiom} $c\!:\!c'$ where $(c,c')\in\mc{A}$.
        \end{enumerate}
        The inference rules of $\sigma$ are as follows. Below, $s\in\mc{S}$, $x\in\mc{V}^s\comp\dom\Gamma$, $(s_1,s_2,s_3)\in\mc{R}$, and $C=_\beta C'$.
        \hfuzz16px\begin{adjustwidth}{-8pt}{0pt}\vspace{-0.1in}
        {\small\begin{equation*}
            \begin{gathered}
                \infer[\mathsc{Init}]{\Gamma,x\!:\!A\proves x\!:\!A}{\Gamma\proves A\!:\!s}\ \ \ \ 
                \infer[\mathsc{Weak}]{\Gamma,x\!:\!A\proves B\!:\!C}{\Gamma\proves A\!:\!s & \Gamma\proves B\!:\!C}\ \ \ \ 
                \infer[\mathsc{Conv}]{\Gamma\proves B\!:\!C'}{\Gamma\proves B\!:\!C & \Gamma\proves C'\!:\!s}\ \ \ \ 
                \infer[\Pi\mathsc{-rule}]{\Gamma\proves(\Pi x\!:\!B_1.B_2)\!:\!s_3}{\Gamma\proves B_1\!:\!s_1 & \Gamma,x\!:\!B_1\proves B_2\!:\!s_2}\\
                \infer[\lambda\mathsc{-rule}]{\Gamma\proves(\lambda x\!:\!B_1.C)\!:\!(\Pi x\!:\!B_1.B_2)}{\Gamma\proves B_1\!:\!s_1 & \Gamma,x\!:\!B_1\proves B_2\!:\!s_2 & \Gamma,x\!:\!B_1\proves C\!:\!B_2}\ \ \ \ 
                \infer[\mathsc{App}]{\Gamma\proves B_1\,B_2\!:\!C_2[B_2/x]}{\Gamma\proves B_1\!:\!(\Pi x\!:\!C_1.C_2) & \Gamma\proves B_2\!:\!C_1}
            \end{gathered}
        \end{equation*}}
        \end{adjustwidth}
    \end{definition}

    \begin{definition}
        A $\sigma$-pseudocontext $\Gamma$ is a \textit{$\sigma$-context} if there are $\sigma$-pseudoterms $A,B$ such that $\Gamma\proves A\!:\!B$. Dually, a $\sigma$-pseudoterms $A$ is a \textit{$\sigma$-term} if there is a $\sigma$-context $\Gamma$ and a $\sigma$-pseudoterm $B$ such that $\Gamma\proves A\!:\!B$.
    \end{definition}

    \begin{lemma}[Substitution Lemma; \cite{GN91}*{Lemma 17}]\label{lem:substitution}
        Let $\Gamma$ and $\Gamma_1,y\!:\!A,\Gamma_2$ be $\sigma$-contexts and let $A,M,N,P$ be $\sigma$-terms. If $\Gamma_1,y\!:\!A,\Gamma_2\proves M\!:\!N$ and $\Gamma\proves P\!:\!A$, then $(\Gamma_1,\Gamma_2)[P/y]\proves M[P/y]\!:\!N[P/y]$.
    \end{lemma}

    \begin{lemma}[Stripping Lemma; \cite{GN91}*{Lemma 19}]\label{lem:stripping}
        Let $\Gamma$ be a $\sigma$-context and let $M,N,P$ be $\sigma$-terms.
        \begin{enumerate}
            \item If $\Gamma\proves c\!:\!P$ where $c\in\mc{C}$, then $P=_\beta c'$ and $(c,c')\in\mc{A}$ for some $c'\in\mc{C}$.
                \vspace{-0.05in}
            \item If $\Gamma\proves x\!:\!P$ where $x\in\mc{V}$, then $P=_\beta Q$ for some $\sigma$-term $Q$ such that $(x\!:\!Q)\in\Gamma$.
                \vspace{-0.05in}
            \item If $\Gamma\proves(\Pi x\!:\!M.N)\!:\!P$, then $\Gamma\proves M\!:\!s_1$, $\Gamma,x\!:\!M\proves N\!:\!s_2$, and $P=_\beta s_3$ for some $(s_1,s_2,s_3)\in\mc{R}$.
                \vspace{-0.05in}
            \item If $\Gamma\proves(\lambda x\!:\!M.N)\!:\!P$, then $\Gamma\proves M\!:\!s_1$, $\Gamma,x\!:\!M\proves Q\!:\!s_2$, $\Gamma,x\!:\!M\proves N\!:\!Q$, $\Gamma\proves P\!:\!s_3$, and $P=_\beta\Pi x\!:\! M.Q$ for some $(s_1,s_2,s_3)\in\mc{R}$ and $\sigma$-term $Q$.
                \vspace{-0.05in}
            \item If $\Gamma\proves M\,N\!:\!P$, then $\Gamma\proves M\!:\!(\Pi x\!:\!A.B)$, $\Gamma\proves N\!:\!A$, and $P=_\beta B[N/x]$ for some $\sigma$-terms $A$ and $B$.
        \end{enumerate}
    \end{lemma}

    \begin{theorem}[Subject Reduction]
        Let $\Gamma,\Gamma'$ be $\sigma$-contexts, $M,M',N$ be $\sigma$-terms, and suppose that $\Gamma\proves M\!:\!N$.
        \begin{enumerate}
            \item If $M\twoheadrightarrow_\beta M'$, then $\Gamma\proves M'\!:\! N$.
                \vspace{-0.05in}
            \item If $\Gamma\twoheadrightarrow_\beta\Gamma'$, then $\Gamma'\proves M\!:\! N$.
        \end{enumerate}
    \end{theorem}
    \begin{proof}
        \TODO
    \end{proof}

    \appendix

    \begin{bibdiv}
        \begin{biblist}*{labels={alphabetic}}
            \bibselect{bibliography}
        \end{biblist}
    \end{bibdiv}
\end{document}
